(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{73:function(t,s,a){"use strict";a.r(s);var e=a(0),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),a("p",[t._v("React 没有提供将可复用性行为“附加”到组件的途径，之前的解决方案有：比如 render props 和 高阶组件。但是这类方案需要重新组织你的组件结构，这可能会很麻烦。")]),t._v(" "),a("p",[t._v("可以使用 Hook 从组件中提取状态逻辑，使得这些逻辑可以单独测试并复用。Hook 使你在无需修改组件结构的情况下复用状态逻辑。 这使得在组件间或社区内共享 Hook 变得更便捷。")]),t._v(" "),t._m(3),t._v(" "),a("p",[t._v("组件起初很简单，但是逐渐会被状态逻辑和副作用充斥。每个生命周期常常包含一些不相关的逻辑。")]),t._v(" "),t._m(4),t._v(" "),a("p",[t._v("比如 this 指向等")]),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),a("p",[a("strong",[t._v("from Dan：")]),a("br"),t._v(" "),a("a",{attrs:{href:"https://overreacted.io/zh-hans/why-do-hooks-rely-on-call-order/",target:"_blank",rel:"noopener noreferrer"}},[t._v("为什么顺序调用对 React Hooks 很重要？"),a("OutboundLink")],1)]),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),a("p",[t._v("详见这个"),a("a",{attrs:{href:"https://codesandbox.io/s/admiring-platform-vkywj?file=/src/App.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("codesandbox 例子"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("点击几次后，你会发现输出如下结果：")]),t._v(" "),t._m(9),a("p",[t._v("那么为什么在浏览器渲染完后，再执行清理的方法还能找到上次的 state 呢？")]),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._m(20),t._v(" "),t._m(21),t._v(" "),t._m(22),t._v(" "),t._m(23),t._v(" "),a("p",[a("code",[t._v("控制 整个 component 不要 re-render")]),a("br"),t._v("\n你可以用 "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/react-api.html#reactmemo",target:"_blank",rel:"noopener noreferrer"}},[t._v("React.memo"),a("OutboundLink")],1),t._v(" 包裹一个组件来对它的 props 进行浅比较：")]),t._v(" "),t._m(24),a("p",[t._v("React.memo 为高阶组件，等效于 PureComponent，但它只比较 props。")]),t._v(" "),a("p",[t._v("如果函数组件被 React.memo 包裹，且其实现中拥有 useState，useReducer 或 useContext 的 Hook，当 context 发生变化时，它仍会重新渲染。")]),t._v(" "),a("p",[t._v("如果你的组件在相同 props 的情况下渲染相同的结果，那么你可以通过将其包装在 React.memo 中调用，以此通过记忆组件渲染结果的方式来提高组件的性能表现。这意味着在这种情况下，React 将跳过渲染组件的操作并直接复用最近一次渲染的结果。")]),t._v(" "),a("p",[t._v("默认情况下其只会对复杂对象做浅层对比，如果你想要控制对比过程，那么请将自定义的比较函数通过第二个参数传入来实现（比较新旧 props。如果函数返回 true，就会跳过更新）。")]),t._v(" "),a("p",[t._v("React.memo() 的使用方式：")]),t._v(" "),t._m(25),a("p",[t._v("使用方式很简单，在 Function Component 之外，在声明一个 areEqual 方法来判断两次 props 有什么不同，如果第二个参数不传递，则默认只会进行 props 的浅比较。")]),t._v(" "),a("p",[t._v("最终 export 的组件，就是 React.memo() 包装之后的组件")]),t._v(" "),a("p",[t._v("React.memo 不比较 state，因为没有单一的 state 对象可供比较。但你也可以让子节点变为纯组件，或者 用 useMemo 优化每一个具体的子节点。")]),t._v(" "),t._m(26),t._v(" "),t._m(27),t._v(" "),a("p",[t._v("useMemo() 基本用法如下：")]),t._v(" "),t._m(28),a("p",[t._v("useMemo() 是在 render 期间执行的，所以不能进行一些额外的副操作，比如网络请求等。")]),t._v(" "),a("p",[t._v("如果没有提供依赖数组（上面的 [a,b]）则每次都会重新计算 memoized 值，也就会 re-render")]),t._v(" "),a("p",[t._v("useMemo 本身也有开销。")]),t._v(" "),a("p",[t._v("useMemo 会记住一些值，同时在后续 render 时，将依赖数组中的值取出来和上一次记录的值进行比较，如果不相等才会重新执行回调函数，否则直接返回记住的值。")]),t._v(" "),a("p",[t._v("这个过程本身就会消耗一定的内存和计算资源。因此，过度使用 useMemo 可能会影响程序的性能。")]),t._v(" "),t._m(29),t._v(" "),a("p",[a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-intro.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档"),a("OutboundLink")],1),a("br"),t._v(" "),a("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-faq.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Hooks FAQ"),a("OutboundLink")],1),a("br"),t._v(" "),a("a",{attrs:{href:"https://mp.weixin.qq.com/s?src=11&timestamp=1628157434&ver=3234&signature=fyA5coriHS5bLBjX0kTdMD9nyJT*-RVmxos64SAxn-s1auTo-j0Vr2w9a8F6WoWjJSg11qel0f0AxYXJ2jyN2cCv5ZKpxttwSYkq4rNiST*Xj5zM-pRaqBmRlnxL0BgQ&new=1",target:"_blank",rel:"noopener noreferrer"}},[t._v("React.memo() 和 useMemo() 的用法与区别"),a("OutboundLink")],1),a("br"),t._v(" "),a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/163493445",target:"_blank",rel:"noopener noreferrer"}},[t._v("JS 核心理论之《React 状态复用与 Hooks 用法》"),a("OutboundLink")],1)])])}),[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"hooks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hooks"}},[this._v("#")]),this._v(" Hooks")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"解决的问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解决的问题"}},[this._v("#")]),this._v(" 解决的问题")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_1-在组件之间复用状态逻辑很难"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-在组件之间复用状态逻辑很难"}},[this._v("#")]),this._v(" 1.在组件之间复用状态逻辑很难")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_2-复杂组件变得难以理解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-复杂组件变得难以理解"}},[this._v("#")]),this._v(" 2.复杂组件变得难以理解")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_3-难以理解的-class"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-难以理解的-class"}},[this._v("#")]),this._v(" 3.难以理解的 class")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"hook-规则"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hook-规则"}},[this._v("#")]),this._v(" Hook 规则")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[s("p",[this._v("只在最顶层使用 Hook，不要在循环，条件或嵌套函数中调用 Hook"),s("br"),this._v("\n因为 React 靠的是 Hook 调用的顺序，来正确地将内部 state 和对应的 Hook 进行关联，所以需要 Hook 的调用顺序在每次渲染中都是相同的。")])]),this._v(" "),s("li",[s("p",[this._v("只在 React 函数中调用 Hook，不在普通的 JavaScript 函数中调用 Hook。你可以："),s("br"),this._v("\n✅ 在 React 的函数组件中调用 Hook"),s("br"),this._v("\n✅ 在自定义 Hook 中调用其他 Hook")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"渲染闭包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#渲染闭包"}},[this._v("#")]),this._v(" 渲染闭包")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("为防止内存泄漏，清除函数会在组件卸载前执行。"),s("br"),this._v("\n如果组件多次渲染，则在执行下一个 effect 之前，上一个 effect 就已被清除, 即执行 return 的函数。")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("执行更新：0\n\n清除上一次副作用：0\n执行更新：1\n\n清除上一次副作用：1\n执行更新：2\n\n清除上一次副作用：2\n执行更新：3\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("原因很简单，我们在 useEffect 中返回的是一个函数，这形成了一个闭包，这能保证我们上一次执行函数存储的变量不被销毁和污染。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"实现一个-usestate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实现一个-usestate"}},[this._v("#")]),this._v(" 实现一个 useState")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("em",[this._v("特点：")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ol",[a("li",[t._v("一个 useState 的基本结构，它接收一个初始值，返回一个状态和一个改变状态的函数")]),t._v(" "),a("li",[t._v("状态存储的实现\n"),a("ul",[a("li",[t._v("新状态替换旧状态")]),t._v(" "),a("li",[t._v("重新渲染组件")])])]),t._v(" "),a("li",[t._v("多个 state 并存")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("useState")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("initialValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" initialValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("setState")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 触发视图重新渲染")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" setState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("blockquote",[a("p",[t._v("this.setState 与 useState 区别")]),t._v(" "),a("ol",[a("li",[t._v("通过 useState 的 setXXX 修改数据，不会和 setState 一样进行对象属性合并，会直接覆盖。")]),t._v(" "),a("li",[t._v("Hooks 函数组件中，存在渲染闭包的概念，在一次渲染闭包中，state 是固定不变的。")]),t._v(" "),a("li",[t._v("Hooks 函数组件，默认开启类"),a("code",[t._v("Object.is")]),t._v("的浅层比较，类似默认开启 PureComponent 的优化方式。")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"实现一个-useeffect"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实现一个-useeffect"}},[this._v("#")]),this._v(" 实现一个 useEffect")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("em",[this._v("特点：")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[this._v("有两个参数 callback 和 dependencies 数组")]),this._v(" "),s("li",[this._v("如果 dependencies 不存在，那么 callback 每次 render 都会执行")]),this._v(" "),s("li",[this._v("如果 dependencies 存在，只有当它发生了变化， callback 才会执行")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" deps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("useEffect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("callback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" depArray")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果 dependencies 不存在")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" shouldUpdate "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("depArray"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 两次的 dependencies 是否完全相等")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" depsChange "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" deps\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("depArray"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("every")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("depItem"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" depItem "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" deps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 如果 dependencies 不存在，或者 dependencies 有变化*/")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("shouldUpdate "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" depsChange"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    deps "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" depArray"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"性能优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#性能优化"}},[this._v("#")]),this._v(" 性能优化")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("减少渲染次数：")]),s("br"),this._v("\n默认情况，只要父组件状态变了（不管子组件依不依赖该状态），子组件也会重新渲染；")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("类组件：可以使用 pureComponent")]),this._v(" "),s("li",[this._v("函数组件(见下文)")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_1-fc-组件实现-shouldcomponentupdate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-fc-组件实现-shouldcomponentupdate"}},[this._v("#")]),this._v(" 1.FC 组件实现 shouldComponentUpdate")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" MyComponent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" React"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("memo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MyComponent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("props")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 使用 props 渲染 */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MyComponent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("props")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 使用 props 渲染 */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("areEqual")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("prevProps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" nextProps")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n  如果把 nextProps 传入 render 方法的返回结果与\n  将 prevProps 传入 render 方法的返回结果一致则返回 true，\n  否则返回 false\n  */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" React"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("memo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MyComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" areEqual"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_2-使用-usememo-进行细粒度性能优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-使用-usememo-进行细粒度性能优化"}},[this._v("#")]),this._v(" 2. 使用 useMemo() 进行细粒度性能优化")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("控制 部分 component 不要进行 re-render")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" memoizedValue "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("useMemo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("computeExpensiveValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"学习资料"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#学习资料"}},[this._v("#")]),this._v(" 学习资料")])}],!1,null,null,null);s.default=n.exports}}]);